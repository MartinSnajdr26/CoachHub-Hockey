<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}{{ brand.team_name or 'CoachHub' }} – Coach Manager{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body style="--brand-primary: {{ brand.primary or '#d4c76f' }}; --brand-secondary: {{ brand.secondary or '#000000' }}; --brand-tertiary: {{ brand.tertiary or '#f5f5f5' }};">

    <!-- Černý vršek s logem -->
    <header class="header-top">
        <div class="logo">
            <img src="{{ brand.logo_url or url_for('static', filename='logo.png') }}" alt="Logo klubu">
            <h1>{{ brand.team_name or 'CoachHub' }} – COACH MANAGER</h1>
        </div>
        {# Vítej/uživatel odstraněn – přihlášení je týmovým klíčem #}
        <a href="{{ url_for('home') }}" class="app-top-right-logo-link" aria-label="Domů">
            <img src="{{ url_for('static', filename='App_Logo.png') }}" alt="App Logo" class="app-top-right-logo">
        </a>
    </header>

    <!-- Bílý pruh s navigací -->
    <div class="header-bottom">
  <nav>
    <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Menu" aria-expanded="false">☰ Menu</button>
    <ul class="nav-left">
      {% if current_user.is_authenticated or team_session_login %}
        <li><a href="{{ url_for('home') }}">🏠 Domů</a></li>
        <li><a href="{{ url_for('players') }}">👥 Hráči</a></li>
        <li><a href="{{ url_for('roster') }}">📋 Soupiska</a></li>
        <li class="dropdown">
          <a href="{{ url_for('lines') }}">🔀 Formace</a>
          <div class="dropdown-menu">
            <a href="{{ url_for('lines') }}">⚙️ Sestavit Formace</a>
            <a href="{{ url_for('lineup_sessions') }}">🗂 Seznam sestav</a>
          </div>
        </li>
        <li class="dropdown">
          <a href="{{ url_for('drills') }}">🏒 Tréninky</a>
          <div class="dropdown-menu">
            <a href="{{ url_for('new_drill') }}">➕ Nové cvičení</a>
            <a href="{{ url_for('drills') }}">📂 Kategorie</a>
            <a href="{{ url_for('drills_select') }}">📄 Export vybraná cvičení</a>
            <a href="{{ url_for('drill_sessions') }}">🗂 Seznam tréninků</a>
            {% if nav_drill_categories %}
              <div class="dropdown-sep"></div>
              {% for cat in nav_drill_categories %}
                <a href="{{ url_for('drills_by_category', category=cat) }}"># {{ cat }}</a>
              {% endfor %}
            {% endif %}
          </div>
        </li>
      {% else %}
        <li><span class="nav-disabled">🏠 Domů</span></li>
        <li><span class="nav-disabled">👥 Hráči</span></li>
        <li><span class="nav-disabled">📋 Soupiska</span></li>
        <li><span class="nav-disabled">🔀 Formace</span></li>
        <li><span class="nav-disabled">🏒 Tréninky</span></li>
      {% endif %}
    </ul>

    <ul class="nav-right">
      {% if current_user.is_authenticated or team_session_login %}
        <li><a href="{{ url_for('settings') }}">⚙️ Nastavení</a></li>
        {% if is_coach %}
          <li><a href="{{ url_for('audit_log') }}">🧾 Audit log</a></li>
        {% endif %}
      {% endif %}
      {% if current_user.is_authenticated %}
        <li><a href="{{ url_for('logout') }}">🚪 Odhlásit</a></li>
      {% elif team_session_login %}
        <li><a href="{{ url_for('team_logout') }}">🚪 Odhlásit</a></li>
      {% else %}
        <li><a href="{{ url_for('team_auth') }}">🔐 Přihlásit (týmový klíč)</a></li>
      {% endif %}
    </ul>
  </nav>
</div>

    <!-- Zlatý obsah -->
    <main>
        {% with msgs = get_flashed_messages(with_categories=true) %}
          {% if msgs %}
            <div style="margin:10px 0;">
              {% for cat, m in msgs %}
                {% set is_err = (cat == 'error') %}
                <div style="padding:10px 14px; border-radius:8px; margin-bottom:6px; background: {{
                  'color-mix(in srgb, var(--tertiary, #c44747) 20%, transparent)'
                  if is_err else
                  'color-mix(in srgb, var(--brand-secondary, #000) 20%, transparent)'
                }}; border:2px solid {{ 'var(--tertiary, #c44747)' if is_err else 'var(--brand-secondary, #000)' }}; color: var(--brand-secondary, #000);">
                  {{ m }}
                </div>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}
        {% block content %}
        {% endblock %}
</main>

    {% block scripts %}{% endblock %}
    <script src="{{ url_for('static', filename='app.js') }}" nonce="{{ csp_nonce }}"></script>

    <footer style="margin-top:40px; padding:16px; text-align:center; color:#fff; border-top: 2px solid #000; background:#000;">
      <a href="{{ url_for('terms') }}" style="margin-right:12px;">Podmínky použití</a>
      <a href="{{ url_for('privacy') }}" style="margin-right:12px;">Zásady ochrany osobních údajů</a>
      <a href="{{ url_for('about') }}">O mně</a>
    </footer>

</body>
</html>
